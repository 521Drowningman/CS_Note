# linux

## 目录结构

linux 没有盘符的概念，只有一个根目录  /  ,所有的文件都在它下面。

在 linux系统中,路径之间的层级关系,使用 / 来表示。 

> 如 /user/local/hello.txt
>
> + 开头的 / 表示根目录
> + 后面的 / 表示层级关系

## linux命令基础

> + 命令就是 linux程序，一个命令就是一个 linux的程序。
>
> 命令通用格式：
>
> `command [-options] [parameter]`
>
> + command: 命令本身
> + -options: [可选，非必填] 命令的一些选项, 可以通过选项控制命令的行为细节
> + parameter: [可选,非必填] 命令的参数,多数用于命令的指向目标等

## ls 命令

> ls 命令的作用是列出目录下的内容,语法细节如下：
>
> `ls [-a -l -h] [linux路径]`
>
> + -a -l -h 是可选的选项
> + linux路径是此命令可选的参数
>
> 当不使用选项和参数，直接使用 ls 命令本体,表示：以平铺的形式,列出当前工作目录下的内容。
>
> + linux 系统在启动时,会将当前登录用户的HOME目录作为工作目录。(在不填入参数时)
> + HOME目录：每个linux 操作用户在linux系统的个人账户目录，路径：/home/用户名
> + 当使用参数时： ls 的参数表示：指定一个 linux 路径，列出指定路径的内容
>
> 选项：
>
> + -a 选项 ，表示：all 的意思，即列出全部文件（包括隐藏的文件/文件夹） (在 linux 中以 . 开头的文件是隐藏文件)
> + -l 选项，表示：以列表(竖向排列) 的形式展示内容,并展示更多信息.
> + 语法中的选项是可以组合在一起使用的，如： ls -a -l
> + -h 选项，表示：以易于阅读的形式，列出文件大小，如 K,M,G   （-h 必须搭配 -l 一起使用）

## 切换工作目录

linux 终端打开时，默认为用户的 HOME目录作为当前的工作目录

可以通过 cd命令，更改当前所在的工作目录。  (change directory) 

> 语法：`cd [linux 路径]`
>
> + 命令无需选项，只需要参数，表示要切换至哪个目录下; 
> + 当不写参数时，表示回到用户的 HOME 目录。
>
> pwd 查看当前工作目录：(print work directory)
>
> 语法： `pwd`       (无选项参数)
>
> 

## 相对路径和绝对路径

> 绝对路径： 以根目录为起点，描述路径的一种写法，路径描述以 / 为开头。
>
> 如： cd / home / zmw / Desktop
>
> 相对路径： 以当前目录为起点，描述路径的一种写法，路径描述无需以 / 开头。
>
> 如： cd Desktop
>
> 
>
> 特殊路径符：
>
> + .   表示当前目录，比如：cd ./Desktop  表示切换到当前目录下的 Desktop目录内.
> + ..  表示上一级目录，比如：cd ..  即可切换到上一级目录，cd ../.. 切换到上二级的目录
> + ~  表示HOME目录，比如：cd ~  即可切换到HOME目录

## 创建文件夹

通过 mkdir 命令创建新的目录（文件夹）(Make Directory)

> 语法：`mkdir [-p] linux路径`
>
> + 参数必填，表示 linux 路径，即要创建的文件夹的路径，相对路径或绝对路径.
> + -p 选项可选，表示自动创建不存在的父目录，适用于创建连续多层级的目录。

## 文件操作命令

> 可以通过 touch 命令创建文件
>
> 语法：`touch linux路径`
>
> + 无选项，参数必填，表示要创建的文件路径，相对、绝对、特殊路径符均可使用。
>
> 
>
> 通过 cat 命令查看文件内容
>
>  语法：`cat linux路径`
>
> + cat 同样没有选项，只有必填参数，参数表示被查看的文件路径。
>
> 
>
> 通过 more 命令查看文件内容 (查看过程中用空格翻页，通过 q 退出查看)
>
> 与 cat的不同之处是：
>
> + cat 是直接将内容全部显示出来
> + more 支持翻页,如果文件内容过多，可以一页页的展示
>
> 语法：`more linux路径`
>
> + 无选项，只有必填参数，参数表示：被查看的文件路径.
>
> 
>
> 通过 cp 命令复制文件和文件夹( copy )
>
> 语法：`cp [-r] 参数1 参数2`
>
> + -r 选项，可选，用于复制文件夹使用，表示递归
> + 参数1，linux 路径，表示被复制的文件或文件夹
> + 参数2，linux 路径，表示要复制去的地方
>
> 
>
> 通过 mv 命令可以用于移动文件\文件夹( move )
>
> 语法：`mv 参数1 参数2`
>
> + 参数1，linux 路径，表示被移动的文件或文件夹
> + 参数2，linux 路径，表示要移动去的地方，如果目标不存在，则进行改名，确保目标存在
>
> 
>
> 通过 rm 命令删除文件\文件夹( remove )
>
> 语法：`rm [-r -f] 参数1 参数2  …… 参数N`
>
> + -r 选项，用于删除文件夹
> + -f 选项，强制删除(不会弹出提示确认信息)
> + 参数表示要删除的文件或文件夹的路径，按照空格隔开，意味着可一次删除多个
>
> rm 命令支持通配符 *, 用来做模糊匹配
>
> +  test* , 表示匹配任何以 test 开头的内容
> + *test , 表示匹配任何以 test 结尾的内容
> + *test * , 表示匹配任何包含 test 的内容 

##  查找

linux 命令，实际上本体是一个个的二进制程序。

> 通过 which 命令, 查看所使用的一系列命令的程序文件存放在哪里
>
> 语法：`which 要查找的命令` 
>
> 
>
> 通过 find 命令按文件名查找文件
>
> 语法：`find 起始路径 -name “被查找文件名”`
>
> + -name 是指按文件名进行搜索
> + 这里“被查找的文件名”也可以使用通配符
>
> 
>
> find 命令还可以按大小查找文件
>
> 语法：`find 起始路径 -size + | -n[KMG]`
>
> + +、- 表示大于和小于
> + n 代表大小数字
> + kMG表示大小单位,k表示kB, M表示MB，G表示GB
>
> 示例：
>
> + 查找小于10kB的文件: find / -size -10k
> + 查找大于100MB的文件：find / -size +100M
> + 查找大于1GB的文件：find / -size +1G

## grep命令

> 可以通过grep命令，从文件中通过关键字过滤文件行
>
> 语法：`grep [-n] 关键字 文件路径`
>
> + 选项 -n , 可选，表示在结果中显示匹配的行的行号
> + 参数，关键字，必填，表示过滤的关键字，带有空格或其他特殊符号，建议使用“”将关键字包围
> + 参数，文件路径，必填，表示要过滤内容的文件路径，可作为内容输入端口
>
> 
>
> 通过 wc 命令统计文件的行数、单词数量
>
> 语法：`wc [-c -m -l -w] 文件路径`
>
> + 选项，-c , 统计 bytes 数量
> + 选项，-m, 统计字符数量
> + 选项，-l, 统计行数
> + 选项，-w, 统计单词数量
> + 参数，文件路径，被统计的文件，可作为内容输入端口
> + 如果什么选项都不加得到的结果是：行数 + 单词数 + 字节数 + 文件名
>
> 
>
> 管道符： | 
>
> 作用：将管道符左边的命令的结果，作为右边命令的输入
>
> 如：cat test.txt | grep zmw
>
> + cat test.txt 的输出结果(文件内容) 作为右边 grep 命令的输入(被过滤的文件) 
>
> 

## echo命令

可以使用该命令在命令行中输出指定的内容

语法：`echo 输出的内容`

+ 无选项，可以有多个参数，表示要输出的内容，输出的内容尽量用 “ ” 来包括

### 反引号``

被反引号包围的内容将被作为命令执行而不是字符串。

```````
echo `pwd`
```````

### 重定向符

两个符号： 

+ `>`,将左侧命令的结果，覆盖写入（将右侧文件清空然后将左侧的结果写入）到符号右侧指定的文件中
+ `>>`,将左侧命令的结果，追加写入到符号右测指定的文件中

```
for instance:
echo "hello linux" > test2.txt
echo "hello zzzz" >> test2.txt
```

## tail命令

使用`tail`命令，可以查看文件尾部的内容，跟踪文件的最新更改：

语法：`tail [-f -num] linux路径`

+ 参数：linux 路径，表示被跟踪的文件路径
+ 选项 -f ，表示持续跟踪。（当跟踪的文件中加入新的内容后，进行实时的跟踪）
+ 选项 -num，表示查看尾部的行数，不填默认是十行

```
tail -20 test2.txt     //输出test2文件中的后20行
```

## 用户

root 用户（超级管理员）

### 切换用户

su命令：（Switch User）

语法：`su [-] [用户名]`

> + `-`符号是可选的，表示是否切换用户后加载环境变量
> + 参数： 用户名,表示要切换的用户，若省略，则表示切换到root用户
> + 切换用户后，可以通过exit 命令回退至上一个用户，也可以使用快捷键:ctrl + d

sudo命令：

因为长期使用root用户，可能会出现不必要的操作导致系统损坏，所以可以使用sudo命令.

sudo命令可以为普通的命令授权，使该命令能临时以root身份执行。

语法： `sudo 其他命令`

> +  并不是所有的用户都有权力使用sudo，我们需要为普通用户配置sudo认证，该用户才有权力使用sudo.

如何配置sudo认证：

> 1. 切换到root用户，执行visudo命令，会自动通过vi编辑器打开: /etc/sudoers 这个文件
> 2. 在文件的最后添加：
> 	`用户名   ALL=(ALL)  <制表符>   NOPASSWD: ALL`
> 	+ NOPASSWD: ALL表示使用该用户使用sudo 命令的时候不用输入密码
> 3. 最后通过wq保存

### 用户组管理

创建用户组： `groupadd 用户组名`

删除用户组： `groupdel 用户组名`

### 用户管理

创建用户：`useradd [-g -d] 用户名`

> + -g 指定用户的组，不指定会创建同名组并加入，指定的组必须要是已经存在的组。
> + -d 指定用户HOME路径，不指定，HOME目录默认在：/home/用户名

删除用户：`userdel [-r] 用户名`

> + -r 删除用户的HOME目录，不使用-r, 在删除用户时，HOME目录保留

查看用户所属组：`id [用户名]`

> + 如果不提供被查看的用户名，则查看自身

修改用户所属组：`usermod -aG 用户组 用户名`

> 将指定用户加入指定的用户组

查看当前系统中有那些用户：`getent passwd`

查看有那些组： `getent group` 

## 权限控制信息

r 表示读权限

w 表示写权限

x 表示执行权限

> 针对文件和文件夹的不同，rwx的含义又有差别：
>
> + r , 针对文件可以查看文件内容； 对文件夹，可以查看文件夹内容。
> + w , 针对文件可以修改文件；对文件，可以在文件夹中创建，删除，改名等操作
> + x , 针对文件表示可以将文件作为程序执行； 对文件夹，表示可以更改工作目录到此文件夹，即能否cd

### chmod命令

用于修改文件和文件夹的权限。

*注意*：只有文件、文件夹的所属对象或root用户才可以修改

语法： `chmod  [-R]  权限  文件或文件夹`

+ -R  ， 对文件夹中全部的内容应用同样的操作。

> 示例：
>
> + `chmod  u = rwx , g = rx , o = x hello.txt`    将文件权限修改为rwxr-x–x
>
> u 表示 user 所属权限 ，g 表示 group组 权限，o 表示 other 其他用户。

权限可以简单的用数字表示：如751  rwx r-x –x 

其实将该权限看作是：二进制即可，7 即3位二进制都取 1 ，即有权限rwx

### chown命令

该命令用于修改文件或文件夹 所属的用户和用户组

该命令只适用于root用户

语法： `chown  [-R]  [用户] [:] [用户组]  文件或文件夹`

+ -R ， 对文件夹内全部内容应用相同的规则
+ :   用于分隔用户和用户组

> 示例：
>
> + `chown root hello.txt ,  将hello.txt 所属用户修改为root`
>
> + `chown :root hello.txt , 将hello.txt所属用户组修改为root`

## 快捷键

ctrl + c  强制停止

ctrl + d 退出或登出； 可以退出账户的登录，或退出某些特定程序的专属页面

history 查看历史输入过的命令

!命令前缀, 自动执行上一次匹配前缀的命令

ctrl + r 输入内容去匹配历史命令

ctrl + l 可以清空终端内容        

## 安装软件

### centos

yum 命令: rpm 包软件管理器,用于自动化安装配置 linux 软件,并可以自动解决依赖问题.

语法: `yum [-y] [install | remove | search] 软件名称`

+ -y , 自动确认,无需手动确认安装或卸载过程

### Ubuntu

语法: `apt [-y] [install | remove | search] 软件名称`

## systemctl命令

linux 系统很多软件(内置或第三方)均支持适用该命令控制: 启动,停止,开机自启;  这些能被控制的软件一般被称为:服务

语法: systemctl  start | stop | status | enable | disable 服务名

> + start 启动
> + stop 停止
> + status 查看状态
> + enable 开启开机自启
> + disable 关闭开机自启

## 软链接

将文件或文件夹链接到其他位置,类似于windows 里的快捷方式

语法: `ln -s 参数1  参数2`

> + -s  创建软链接
> + 参数1 : 被链接的文件或文件夹
> + 参数2 : 要链接去的目的地

## 日期和时区

### date

可以通过该命令在命令行中查看系统的时间.

语法: `date [-d] [+格式化字符串]`

> + -d 按照给定的字符串显示日期,一般用于日期计算
> + 格式化字符串: 通过特定的字符串标记,来控制显示的日期格式
> + %Y  年
> + %y  年份后两位数字
> + %m  月份
> + %d  日
> + %H  小时
> + %M  分钟
> + %S  秒
> + %s  自 1970-01-01  00:00:00  UTC  到现在的秒数

````
-d 的用法
date -d "+1 day" [+格式化字符串]
//显示后一天的日期
````

### 修改时区

使用root权限

````
rm -f /etc/localtime
ln -s /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

也可以用ntp程序自动校准系统
````

## 网络请求和下载

### ping

通过ping命令，检查指定的网络服务器是否是可以联通的状态.

语法： `ping [-c num] ip或主机名`

+ -c 检查的次数，不使用-c 选项, 将无限次数持续检查
+ ip 或主机名，被检查的服务器的ip地址或主机名地址

### wget

wget 是非交互式的文件下载器，可以在命令行内下载网络文件

语法： `wget [-b] url`

+ -b 可选，后台下载，会将日志写入到当前工作目录的wget-log文件中
+ url 下载链接

### curl

该命令可以发送http网络请求,可用于：下载文件，获取信息

语法： `curl [-o] url`

+ -O 用于下载文件，当url是下载链接时，可以使用此选项保存文件
+ url 要发起请求的网络地址

## 进程

程序运行在操作系统中，操作系统在管理这些程序时会将这些程序注册为：进程

并会为每一个进程分配一个独有的：进程ID

### 查看进程

语法： `ps [-e  -f]`

+ -e 显示出全部的进程
+ -f 以完全格式化的形式展示信息
+ 一般来说固定格式：`ps -ef`

### 关闭进程

语法： kill [-9] 进程ID

+ -9 ,表示强制关闭进程，不使用该选项会向进程发送信号要求其关闭，但是否关闭看进程自身的处理机制

## 查看系统资源占用

命令：`top`

## 压缩和解压

linux 系统常用有两种压缩格式：

+  .tar , 这种压缩方式只是简单的将文件组装到一个.tar的文件, 并没有太多文件体积的减少 , 仅仅是简单的封装；
+ .ge ， 该压缩方式使用gzip压缩算法将文件压缩到一个文件内，可以极大的减少压缩后的体积；

语法： `tar [-c -v -x -f -z -C] 参数1 参数2 ….. 参数N`

具体选项的作用随查随用；

### zip命令

压缩为zip压缩包；

语法： `zip [-r] 参数1 参数2 ….. 参数N`

+ -r , 被压缩的包含文件夹的时候, 需要使用 -r 选项；

解压：

语法：`unzip [-d] 参数`

+ -d , 指定要解压去的位置
+ 参数, 被解压的zip压缩包文件;

## 花括号{}

```bash
convert image.{png,jpg}
# 会展开为
convert image.png image.jpg

cp /path/to/project/{foo,bar,baz}.sh /newpath
# 会展开为
cp /path/to/project/foo.sh /path/to/project/bar.sh /path/to/project/baz.sh /newpath

# 也可以结合通配使用
mv *{.py,.sh} folder
# 会移动所有 *.py 和 *.sh 文件

mkdir foo bar

# 下面命令会创建foo/a, foo/b, ... foo/h, bar/a, bar/b, ... bar/h这些文件
touch {foo,bar}/{a..h}
touch foo/x bar/y
# 比较文件夹 foo 和 bar 中包含文件的不同
diff <(ls foo) <(ls bar)
# 输出
# < x
# ---
# > y
```

## 在学习过程中遇到的命令

### 查看文件类型

基础用法:

`file 文件名`,用于查看该文件的类型.

# vim编辑器

vi \ vim 编辑器，就是命令行模式下的文本编辑器，用来编辑文件。

## 命令模式

可以由该模式进入输入模式和底线命令模式。

如果需要通过vim编辑器编辑文件，命令：

````
vi 文件路径
vim 文件路径
````

vim兼容全部vi的功能，所以直接使用vim命令即可

> + 如果文件路径所表示的文件不存在，那么此命令会用于编辑一个新文件
> + 如果存在，那么就会编辑该已有的文件

**快捷键：**还有很多随用随搜

> 命令模式：
>
> i        在当前光标位置进入输入模式
>
> a       在当前光标位置之后进入输入模式
>
> I        在当前行的开头进入输入模式
>
> A       在当前行的结尾进入输入模式
>
> o       在当前光标的下一行进入输入模式
>
> 0       在当前光标的上一行进入输入模式

> 输入模式：
>
> esc    任何情况下输入`esc`都能会到命令模式

## 输入模式

在命令模式中按下 `i`键进入.

按下`esc`退出输入模式回到命令模式. 

+ 在输入模式下无其他指令使用，该模式用于自由编辑.

> x       删除光标处的字符

![image-20240906170536118](../../../AppData/Roaming/Typora/typora-user-images/image-20240906170536118.png)

## 底线命令模式

在命令模式内，输入 `:`，进入该模式.

> 命令：
>
> :wq        保存并退出
>
> :q           仅退出
>
> :q!          强制退出
>
> :w          仅保存
>
> :set nu  显示行号
>
> :set paste 设置粘贴模式

## 查找模式

1. 在normal 模式下按下 `/` 进入查找模式.
2. 输入要查找的字符串,vim会跳转到第一个匹配的位置.
3. 按下n查找下一个,按下N查找上一个.
4. vim 查找支持正则表达式.

# Shell脚本

## 变量

```bash
#定义变量:
foo=bar    
echo $foo  #通过$符访问变量
#打印 bar

#在bash中要注意空格;shell脚本中的空格起分割参数的作用；
foo = bar   #出错,因为这里shell会将 foo 当作程序而 = 和 bar 当作foo这个程序的参数.

echo "$foo"     #bash中的字符串通过''和""来定义,以''定义的字符串为原义字符串,其中的变量不会被转义;而""定义的字符串会 将 # 打印 bar       #变量值进行替换
echo '$foo'
# 打印 $foo

foo=$(pwd)     #pwd的执行结果替换了$(pwd)
echo $foo
# 打印当前工作目录
```

> - `$0` - 脚本名
> - `$1` 到 `$9` - 脚本的参数。 `$1` 是第一个参数，依此类推。
> - `$@` - 所有参数
> - `$#` - 参数个数
> - `$?` - 前一个命令的返回值
> - `$$` - 当前脚本的进程识别码
> - `!!` - 完整的上一条命令，包括参数。常见应用：当你因为权限不足执行命令失败时，可以使用 `sudo !!`再尝试一次。
> - `$_` - 上一条命令的最后一个参数。如果你正在使用的是交互式 shell，你可以通过按下 `Esc` 之后键入 . 来获取这个值。

## 运算符

命令执行后,如果正常执行,则可以得到返回值为0的退出码 ; 其他所有非0的返回值都表示有错误发生.

````bash
false || echo "Oops, fail"
# Oops, fail

true || echo "Will not be printed"
#

true && echo "Things went well"
# Things went well

false && echo "Will not be printed"
#

false ; echo "This will always run"    #这里这个;号相当于进行换行了
# This will always run
````

## 进程替换

```bash
diff <(ls dir1) <(ls dir2)

在这个命令中：
ls dir1 会列出 dir1 目录的内容。
ls dir2 会列出 dir2 目录的内容。
<(ls dir1) 和 <(ls dir2) 会分别创建包含 ls dir1 和 ls dir2 输出的虚拟文件。
diff 命令会比较这两个虚拟文件的内容，显示它们之间的差异。
```

## 语法

if语句

```bash
if condition; then
    # 如果条件为真，执行这里的代码
else
    # 如果条件为假，执行这里的代码
fi  #用于结束if语句块
```

for循环

```bash
for variable in list; do
    # 循环体，重复执行的代码
done
```

while循环

```bash
while condition; do
    # 循环体，重复执行的代码
done
```

查看比较符手册: man test  
